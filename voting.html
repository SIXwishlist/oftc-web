---
layout: master
title: Voting
---
<input type="button" class="btn" id="rawballot" value="Get Raw Ballot" />
<table id="members">
    <thead>
        <tr>
            <th class='index'>Rank</th>
            <th></th>
            <th>Name</th>
            <th>Nick</th>
            <th>Sponsor</th>
            <th>Obmusdman</th>
            <th>Remove</th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>

<input type="button" class="btn" id="submit" value="Process" />

<div id="overlay" class="modal hide fade" style='max-height: 550px;overflow-y: auto;width: 750px;margin-left: -375px;'>
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
        <h3 id="myModalLabel">Your Ballot</h3>
    </div>
    <div id="overlay-content">
    </div>
</div>
<script type="text/javascript">
var voteMembers = $.getJSON('/staff.json', function(data)
{
    var index = 0;
    $.each(data["staff"], function(i, root)
    {
      $.each(root, function(j, item)
      {
        var newRow = $("<tr class='item'>").appendTo("#members");
        
        var col = $("<td class='index'>").appendTo(newRow);
        col.append(index + 1)
        col = $("<td>").appendTo(newRow);
        col.append("<i class='handle icon-cog'>");
        addCol(newRow, { type: "text", id: "name" + index, name: "Name", value: item["Name"], readonly: true });
        addCol(newRow, { type: "text", id: "nick" + index, name: "nick", value: item["Nick"], readonly: true });
        addCol(newRow, { type: "checkbox", id: "sponsor" + index, name: "sponsor", value: item["Sponsor"], disabled: "disabled" });
        addCol(newRow, { type: "checkbox", id: "ombudsman" + index, name: "ombudsman" });
        addCol(newRow, { type: "checkbox", id: "remove" + index, name: "remove" });

        index++;
      });
    });
});

function addCol(row, attr)
{
    row.append($("<td>").append($("<input>").attr(attr)));
}

updateIndex = function(e, ui) 
{
    $('td.index', ui.item.parent()).each(function (i) 
    {
        $(this).html(i + 1);
    });
};

$("#members tbody").sortable(
{
    handle: '.handle',
    stop: updateIndex
});

$("#rawballot").click(function()
{
    $.get('/ballot', function (tmpl) 
    { 
        var ballot = Hogan.compile(tmpl);
        $.getJSON('/staff.json', function (staff) 
        {
            $('#overlay-content').html(ballot.render(staff));
            $('#overlay').modal({keyboard: true});
        })
    });
});

$("#submit").click(function()
{
   $("tr.item").each(function()
   {
   });
});
</script>
