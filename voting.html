---
layout: master
title: Voting
---
<input type="button" class="btn" id="rawballot" value="Get Raw Ballot" />
<table id="members">
    <thead>
        <tr>
            <th class='index'>Rank</th>
            <th></th>
            <th>Name</th>
            <th>Nick</th>
            <th>Sponsor</th>
            <th>Obmusdman</th>
            <th>Remove</th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>

<input type="button" class="btn" id="submit" value="Process" />

<div id="overlay" class="modal hide fade" style='max-height: 550px;overflow-y: auto;width: 750px;margin-left: -375px;'>
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
        <h3 id="myModalLabel">Your Ballot</h3>
    </div>
    <div id="overlay-content">
    </div>
</div>
<script type="text/javascript">
    var staff = { "staff": [] };

    function ProcessJSON()
    {
        $.getJSON("/staff.json", function() {
        })
        .error(function() 
        { 
            alert("error"); 
        })
        .done(function(data) 
        { 
            $.each(data["staff"], function(i, item)
            {
                staff.staff.push({ Nick: item["Nick"], Name: item["Name"] });
            }); 

            $.each(staff["staff"], function(i, item)
            {
                var newRow = $("<tr>").appendTo("#members");
           
                var col = $("<td class='index'>").appendTo(newRow);
                col.append(i + 1)
                col = $("<td>").appendTo(newRow);
                col.append("<i class='handle icon-cog'>");
                AddCol(newRow, { type: "text", id: "name" + i, name: "Name", value: item["Name"], readonly: true });
                AddCol(newRow, { type: "text", id: "nick" + i, name: "nick", value: item["Nick"], readonly: true });
                AddCol(newRow, { type: "checkbox", id: "sponsor" + i, name: "sponsor", value: item["Sponsor"], disabled: "disabled" });
                AddCol(newRow, { type: "checkbox", id: "ombudsman" + i, name: "ombudsman" });
                AddCol(newRow, { type: "checkbox", id: "remove" + i, name: "remove" });
            });
        });
    }

    ProcessJSON();

    function AddCol(row, attr)
    {
        row.append($("<td>").append($("<input>").attr(attr)));
    }

    updateIndex = function(e, ui) 
    {
        $('td.index', ui.item.parent()).each(function (i) 
        {
            $(this).html(i + 1);
        });
    };

    $("#members tbody").sortable(
    {
        handle: '.handle',
        stop: updateIndex
    });

    $("#rawballot").click(function()
    {
        $.get('/ballot', function (tmpl) 
        { 
            var ballot = Hogan.compile(tmpl);
            $('#overlay-content').html(ballot.render(staff));
            $('#overlay').modal({keyboard: true});
        });
    });

    $("#submit").click(function()
    {
       $("tr.item").each(function()
       {
       });
    });
</script>
